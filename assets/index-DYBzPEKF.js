(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const h of s.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();const d=document.getElementById("canvas"),n=d.getContext("2d"),f=4,w=144*f,N=144*f;d.width=w;d.height=N;const S=1.5,F=96;function c(t){return t/(w/f/(S*f))*F}function T(t){return c(t+72)}function W(t){return c(72-t)}function C(t){return(t-90)*(Math.PI/180)}function E(t){return t*Math.PI/180}function D(t){return t*180/Math.PI}function l(t,e,r){return Math.max(e,Math.min(r,t))}function R(t){return(t%360+360)%360}function X(t){var e=new Image;return e.src=t,e}class ${width;height;maxSpeed;trackWidth;x=0;y=0;angle=0;color;dt=0;constructor(e,r,o,i){this.width=e,this.height=r,this.maxSpeed=o,this.trackWidth=i,this.color="#969696ff"}set_x(e){this.x=l(e,-72+this.width/2,72-this.width/2)}set_y(e){this.y=l(e,-72+this.height/2,72-this.height/2)}set_angle(e){this.angle=(e%360+360)%360}get_x(){return this.x}get_y(){return this.y}get_angle(){return this.angle}tankDrive(e,r){const o=this.trackWidth,i=this.maxSpeed,s=l(e,-1,1),h=l(r,-1,1),_=s*i,m=h*i,y=(m+_)/2,b=(_-m)/o,k=this.get_angle(),u=E(k),P=Math.sin(u),I=Math.cos(u),L=this.get_x()+y*P*this.dt,M=this.get_y()+y*I*this.dt,O=u+b*this.dt;let g=D(O);g=R(g),this.set_x(L),this.set_y(M),this.set_angle(g)}draw_odom_data(){n.save(),n.font="20px Calibri",n.fillStyle="white",n.textBaseline="top",n.fillText(`Î¸: ${this.get_angle().toFixed(2)}`,20,20),n.fillText(`X: ${this.get_x().toFixed(2)}`,20,45),n.fillText(`Y: ${this.get_y().toFixed(2)}`,20,70),n.restore()}draw_chassis(){n.save(),n.translate(T(this.x),W(this.y)),n.rotate(C(this.angle)),n.fillStyle=this.color,n.fillRect(-c(this.width)/2,-c(this.height)/2,c(this.width),c(this.height)),n.beginPath(),n.moveTo(0,0),n.lineTo(c(this.width)/2,0),n.strokeStyle="black",n.lineWidth=2,n.stroke(),n.restore()}render(e){this.draw_chassis(),this.draw_odom_data(),this.dt=e}}const a=Object.create(null),j=Object.create(null);document.addEventListener("keydown",t=>{a[t.key]=!0});document.addEventListener("keyup",t=>{a[t.key]=!1,j[t.key]=!1});let q=X("./empty_field.png");function A(){n.drawImage(q,0,0,d.width,d.height)}function B(t){let e=0,r=0;a.w&&(e+=1),a.s&&(e-=1),a.d&&(r+=.05),a.a&&(r-=.05);const o=e+r,i=e-r;t.tankDrive(o,i)}let p=new $(14,14,25,.4);function H(t){A(),p.render(t),B(p)}let x=0;const Y=60,K=1e3/Y;function v(t){let e=t-x;e>=K&&(x=t,H(e/1e3)),window.requestAnimationFrame(v)}v(0);
